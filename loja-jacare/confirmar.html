<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Confirmar Pedido</title>
</head>
<body style="font-family: Arial; text-align:center; padding:40px;">
  <h2>Confirmando pedido...</h2>
  <div id="debug" style="background:#f0f0f0; padding:20px; margin:20px; text-align:left;"></div>
  
  <script>
    const debug = document.getElementById('debug');
    
    const params = new URLSearchParams(window.location.search);
    const codigo = params.get("codigo");
    const token = params.get("token");
    
    debug.innerHTML += `<p>ğŸ“¦ CÃ³digo: ${codigo}</p>`;
    debug.innerHTML += `<p>ğŸ”‘ Token: ${token}</p>`;
    
    fetch("/api/confirmar", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ codigo, token })
    })
    .then(res => res.json())
    .then(data => {
      debug.innerHTML += `<p>âœ… Resposta: ${JSON.stringify(data)}</p>`;
      if (data.sucesso) {
        document.body.innerHTML = "<h2>âœ… Pedido confirmado com sucesso!</h2>";
      } else {
        document.body.innerHTML = "<h2>âŒ Erro ao confirmar pedido.</h2>";
      }
    })
    .catch(err => {
      debug.innerHTML += `<p>âŒ Erro: ${err.message}</p>`;
    });
  </script>
</body>
</html>